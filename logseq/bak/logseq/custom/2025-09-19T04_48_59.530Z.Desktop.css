/* =============== 基础：字体与渲染（macOS 友好） =============== */
:root {
  /* 正文字号与行距（可按需微调） */
  --page-font-size: 17px;
  --page-line-height: 1.7;
  --page-max-width: 860px; /* 正文最大宽度，增强长文可读性 */

  /* 颜色变量（亮主题） */
  --acc-primary: #2563eb;    /* 主色：蓝 */
  --acc-muted:   #64748b;    /* 次要文字 */
  --bg-1: #ffffff;
  --bg-2: #f7f8fa;
  --bg-3: #eef2f7;
  --tx-1: #1f2937;           /* 主文本 */
  --tx-2: #475569;           /* 次文本 */
  --link: #0ea5e9;
  --mark: #fff3a3;
  --border: #e5e7eb;
  --code-bg: #f8fafc;
}

/* 暗主题变量（Logseq 使用 data-theme 标记） */
html[data-theme="dark"] {
  --acc-primary: #60a5fa;
  --acc-muted:   #94a3b8;
  --bg-1: #0f1115;
  --bg-2: #131720;
  --bg-3: #1b2230;
  --tx-1: #e5e7eb;
  --tx-2: #a8b0bf;
  --link: #7dd3fc;
  --mark: #3a3a00;
  --border: #263042;
  --code-bg: #0d1117;
}

/* 系统字体栈：中英混排友好，等宽优先 SF Mono / JetBrains Mono */
:root, html, body {
  --ui-sans: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue",
             "PingFang SC", "Hiragino Sans GB", "Noto Sans CJK SC",
             "Segoe UI", Roboto, "Helvetica", Arial, "Microsoft YaHei",
             "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
  --ui-mono: ui-monospace, "SF Mono", "JetBrains Mono", "Menlo", "Roboto Mono",
             "Fira Code", "Source Code Pro", "Courier New", monospace;

  font-family: var(--ui-sans);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* =============== 布局与正文 =============== */
#root,
#app-container {
  background: var(--bg-1);
  color: var(--tx-1);
}
html[data-theme="dark"] #root,
html[data-theme="dark"] #app-container {
  background: var(--bg-1);
}

.cp__sidebar-main-content,
.cp__content {
  max-width: var(--page-max-width);
  margin: 0 auto;
  font-size: var(--page-font-size);
  line-height: var(--page-line-height);
}

/* 页面标题 */
.page-title,
.ls-page-title {
  font-weight: 700;
  letter-spacing: 0.2px;
  color: var(--tx-1);
}

/* 段落与块间距 */
.ls-block {
  margin-top: 6px;
  margin-bottom: 6px;
}
.ls-block:hover {
  background: color-mix(in oklab, var(--bg-2) 75%, transparent);
  transition: background .15s ease;
}

/* 当前聚焦块高亮 */
.block-control .block-control-inner,
.ls-block:has(.block-properties):hover {
  border-radius: 8px;
}
.block-focus {
  background: color-mix(in oklab, var(--bg-3) 90%, transparent) !important;
}

/* 列表缩进与对齐（圆点稍显眼） */
.block-marker, .bullet-container .bullet {
  transform: scale(1.08);
  border-color: var(--tx-2) !important;
}
.ls-block .block-content {
  color: var(--tx-1);
}

/* =============== 链接 / 标签 / 引用 =============== */
a, .page-reference {
  color: var(--link);
  text-underline-offset: 3px;
}
a:hover, .page-reference:hover {
  filter: brightness(1.1);
}

a.tag,
.page-tags .tag {
  display: inline-flex;
  align-items: center;
  padding: 0 6px;
  height: 20px;
  border-radius: 999px;
  background: var(--bg-2);
  color: var(--acc-muted);
  border: 1px solid var(--border);
  font-size: 12px;
}
html[data-theme="dark"] a.tag,
html[data-theme="dark"] .page-tags .tag {
  background: var(--bg-2);
  color: var(--tx-2);
  border-color: var(--border);
}

/* 引用与块引用 */
blockquote, .ls-page-blockquote {
  background: var(--bg-2);
  border-left: 3px solid var(--acc-primary);
  padding: 8px 12px;
  border-radius: 6px;
  color: var(--tx-1);
}
.block-ref {
  background: color-mix(in oklab, var(--bg-2) 85%, transparent);
  border-bottom: 1px dashed var(--border);
  padding: 0 2px;
  border-radius: 4px;
}

/* 高亮 */
mark, .marker {
  background: var(--mark);
  color: inherit;
  border-radius: 3px;
  padding: 0 2px;
}

/* =============== 代码与等宽文本 =============== */
code, pre, .code {
  font-family: var(--ui-mono);
}
.CodeMirror, pre {
  background: var(--code-bg) !important;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px 12px;
  line-height: 1.6;
  overflow: auto;
}
:not(pre) > code {
  background: color-mix(in oklab, var(--code-bg) 85%, transparent);
  padding: 1px 4px;
  border-radius: 4px;
  border: 1px solid var(--border);
}

/* =============== 表格可读性 =============== */
table {
  border-collapse: separate;
  border-spacing: 0;
  width: 100%;
  font-size: 0.97em;
}
thead th {
  background: var(--bg-2);
  color: var(--tx-1);
  position: sticky;
  top: 0;
}
tbody tr:nth-child(even) {
  background: color-mix(in oklab, var(--bg-2) 60%, transparent);
}
td, th {
  border-bottom: 1px solid var(--border);
  padding: 8px 10px;
}

/* =============== 侧边栏与面板 =============== */
.cp__sidebar-left-layout, .cp__right-sidebar {
  background: var(--bg-2);
  border-left: 1px solid var(--border);
  border-right: 1px solid var(--border);
}
.cp__right-sidebar .sidebar-item {
  background: var(--bg-1);
  border: 1px solid var(--border);
  border-radius: 10px;
  margin: 8px 8px 12px;
  padding: 8px;
}

/* =============== 搜索与菜单 =============== */
.ui__modal, .ui__button, .dropdown-wrapper, .tippy-box {
  backdrop-filter: saturate(1.2) blur(6px);
  border: 1px solid var(--border);
}

/* =============== 与 Logseq 变量的桥接（部分变量会被主题读取） =============== */
#root>div {
  --ls-primary-background-color: var(--bg-1);
  --ls-secondary-background-color: var(--bg-2);
  --ls-tertiary-background-color: var(--bg-3);
  --ls-primary-text-color: var(--tx-1);
  --ls-secondary-text-color: var(--tx-2);
  --ls-block-highlight-color: color-mix(in oklab, var(--bg-3) 92%, transparent);
  --ls-link-text-color: var(--link);
  --ls-page-mark-color: var(--mark);
  --ls-border-color: var(--border);
}
